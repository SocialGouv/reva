enum Duration {
  unknown
  lessThanOneYear
  betweenOneAndThreeYears
  moreThanThreeYears
  moreThanFiveYears
  moreThanTenYears
}

enum CandidateTypology {
  NON_SPECIFIE
  SALARIE_PRIVE
  SALARIE_PUBLIC_HOSPITALIER
  DEMANDEUR_EMPLOI
  AIDANTS_FAMILIAUX
  AUTRE
}

enum CandidacyStatusStep {
  ARCHIVE
  PROJET
  VALIDATION
  PRISE_EN_CHARGE
  PARCOURS_ENVOYE
  PARCOURS_CONFIRME
  DEMANDE_FINANCEMENT_ENVOYE
  DEMANDE_PAIEMENT_ENVOYEE
  DOSSIER_PRO
  CERTIFICATION
}

# QUERY

type Candidacy {
  id: ID!
  deviceId: ID
  candidate: Candidate
  certificationId: ID
  regionId: ID
  region: Region
  department: Department
  organismId: UUID
  organism: Organism
  certification: Certification
  isCertificationPartial: Boolean!
  experiences: [Experience!]!
  goals: [CandidateGoal!]!
  firstname: String
  lastname: String
  phone: String
  email: String
  typology: CandidateTypology
  typologyAdditional: String
  firstAppointmentOccuredAt: Timestamp
  appointmentCount: Int
  wasPresentAtFirstAppointment: Boolean
  candidacyStatuses: [CandidacyStatus!]!
  certificateSkills: String
  otherTraining: String
  individualHourCount: Int
  collectiveHourCount: Int
  additionalHourCount: Int
  validatedByCandidate: Boolean
  basicSkillIds: [UUID!]!
  basicSkills: [BasicSkill!]!
  mandatoryTrainingIds: [UUID!]!
  mandatoryTrainings: [Training!]!
  candidacyDropOut: CandidacyDropOut
  createdAt: Timestamp!
  admissibility: Admissibility!
}

type CandidacyDropOut {
  dropOutReason: DropOutReason!
  droppedOutAt: Timestamp!
  otherReasonContent: String
  status: CandidacyStatusStep!
}

type CandidacySummary {
  id: ID!
  deviceId: ID!
  certificationId: ID
  certification: CertificationSummary
  organismId: ID
  organism: Organism
  department: Department
  firstname: String
  lastname: String
  phone: String
  email: String
  isDroppedOut: Boolean!
  lastStatus: CandidacyStatus!
  createdAt: Timestamp!
  sentAt: Timestamp
}

type CertificationSummary {
  id: ID!
  label: String!
  acronym: String!
}

type CandidacyStatus {
  id: ID!
  status: CandidacyStatusStep!
  isActive: Boolean!
  createdAt: Timestamp!
}

type Experience {
  id: ID!
  title: String!
  startedAt: Timestamp!
  duration: Duration!
  description: String!
}

type CandidateGoal {
  goalId: ID!
  additionalInformation: String
}

type Organism {
  id: UUID!
  label: String!
  address: String!
  zip: String!
  city: String!
  contactAdministrativeEmail: String!
}

type Training {
  id: ID!
  label: String!
}

type BasicSkill {
  id: UUID!
  label: String!
}

type Query {
  getCandidacy(deviceId: ID!): Candidacy
  getCandidacyById(id: ID!): Candidacy
  getCandidacies: [CandidacySummary!]!
  getTrainings: [Training!]!
  getOrganismsForCandidacy(candidacyId: UUID!): [Organism!]!
  getCompanionsForCandidacy(candidacyId: UUID!): [Organism!]!
  getBasicSkills: [BasicSkill!]!
}

type Admissibility {
  isCandidateAlreadyAdmissible: Boolean!
  reportSentAt: Timestamp
  certifierRespondedAt: Timestamp
  responseAvailableToCandidateAt: Timestamp
  status: AdmissibilityStatus
}

enum AdmissibilityStatus {
  ADMISSIBLE
  NOT_ADMISSIBLE
}

# MUTATIONS

input CandidacyInput {
  deviceId: ID!
  certificationId: ID!
  regionId: ID!
}

input CertificationChangeInput {
  candidacyId: ID!
  certificationId: ID!
}

input ExperienceInput {
  title: String!
  startedAt: Timestamp!
  duration: Duration!
  description: String!
}

input CandidateGoalInput {
  goalId: ID!
  additionalInformation: String
}

input CandidateTypologyInformationsInput {
  typology: CandidateTypology!
  additionalInformation: String
}

input AppointmentInformationsInput {
  firstAppointmentOccuredAt: Timestamp
  wasPresentAtFirstAppointment: Boolean!
  appointmentCount: Int!
}

input TrainingInput {
  certificateSkills: String!
  otherTraining: String!
  individualHourCount: Int!
  collectiveHourCount: Int!
  additionalHourCount: Int!
  validatedByCandidate: Boolean!
  basicSkillIds: [UUID!]!
  mandatoryTrainingIds: [UUID!]!
  isCertificationPartial: Boolean!
}

input DropOutInput {
  droppedOutAt: Timestamp!
  dropOutReasonId: UUID!
  otherReasonContent: String
}

input AdmissibilityInput {
  isCandidateAlreadyAdmissible: Boolean!
  reportSentAt: Timestamp
  certifierRespondedAt: Timestamp
  responseAvailableToCandidateAt: Timestamp
  status: AdmissibilityStatus
}

type Mutation {
  candidacy_createCandidacy(candidacy: CandidacyInput!): Candidacy
  candidacy_submitCandidacy(deviceId: ID!, candidacyId: ID!): Candidacy
  candidacy_updateCertification(
    deviceId: ID!
    candidacyId: ID!
    certificationId: ID!
    departmentId: ID!
  ): Candidacy
  candidacy_addExperience(
    deviceId: ID!
    candidacyId: ID!
    experience: ExperienceInput
  ): Experience
  candidacy_updateExperience(
    deviceId: ID!
    candidacyId: ID!
    experienceId: ID!
    experience: ExperienceInput
  ): Experience
  candidacy_removeExperience(
    deviceId: ID!
    candidacyId: ID!
    experienceId: ID!
  ): Void
  candidacy_updateGoals(
    deviceId: ID!
    candidacyId: ID!
    goals: [CandidateGoalInput!]!
  ): Int!
  candidacy_updateContact(
    deviceId: ID!
    candidacyId: ID!
    email: String
    phone: String
  ): Candidacy
  candidacy_archiveById(candidacyId: ID!): Candidacy!
  candidacy_deleteById(candidacyId: ID!): String!
  candidacy_updateAppointmentInformations(
    candidacyId: ID!
    candidateTypologyInformations: CandidateTypologyInformationsInput!
    appointmentInformations: AppointmentInformationsInput!
  ): Candidacy!
  candidacy_takeOver(candidacyId: ID!): Candidacy!
  candidacy_selectOrganism(candidacyId: UUID!, organismId: UUID!): Candidacy!
  candidacy_submitTrainingForm(
    candidacyId: UUID!
    training: TrainingInput!
  ): Candidacy!
  candidacy_confirmTrainingForm(candidacyId: UUID!): Candidacy!
  candidacy_dropOut(candidacyId: UUID!, dropOut: DropOutInput!): Candidacy!
  candidacy_updateAdmissibility(
    candidacyId: UUID!
    admissibility: AdmissibilityInput!
  ): Admissibility!
}
