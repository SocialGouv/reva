import { Either, Left, Right } from "purify-ts";
import * as domain from '../../../domain/types/candidacy';
import { prismaClient } from "./client";

export const getVulnerabilityIndicators = async (): Promise<Either<string, domain.VulnerabilityIndicator[]>> => {
    try {
        const vulnerabilityIndicators = await prismaClient.vulnerabilityIndicator.findMany();

        return Right(vulnerabilityIndicators);
    } catch (e) {
        return Left(`error while retrieving vulnerability indicators`);
    };
};