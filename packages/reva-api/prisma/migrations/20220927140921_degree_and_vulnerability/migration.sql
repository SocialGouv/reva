-- AlterTable
ALTER TABLE "candidacy" ADD COLUMN     "degree_id" UUID,
ADD COLUMN     "vulnerability_indicator_id" UUID;

-- CreateTable
CREATE TABLE "degree" (
    "id" UUID NOT NULL DEFAULT uuid_generate_v4(),
    "code" VARCHAR(255) NOT NULL,
    "label" VARCHAR(255) NOT NULL,
    "long_label" VARCHAR(255) NOT NULL,
    "level" INTEGER NOT NULL,
    "created_at" TIMESTAMPTZ(6) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updated_at" TIMESTAMPTZ(6),

    CONSTRAINT "degree_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "vulnerability_indicator" (
    "id" UUID NOT NULL DEFAULT uuid_generate_v4(),
    "label" VARCHAR(255) NOT NULL,
    "created_at" TIMESTAMPTZ(6) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updated_at" TIMESTAMPTZ(6),

    CONSTRAINT "vulnerability_indicator_pkey" PRIMARY KEY ("id")
);

-- CreateIndex
CREATE UNIQUE INDEX "degree_code_key" ON "degree"("code");

-- CreateIndex
CREATE UNIQUE INDEX "degree_label_key" ON "degree"("label");

-- CreateIndex
CREATE UNIQUE INDEX "degree_long_label_key" ON "degree"("long_label");

-- CreateIndex
CREATE UNIQUE INDEX "vulnerability_indicator_label_key" ON "vulnerability_indicator"("label");

-- AddForeignKey
ALTER TABLE "candidacy" ADD CONSTRAINT "candidacy_degree_id_fkey" FOREIGN KEY ("degree_id") REFERENCES "degree"("id") ON DELETE SET NULL ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "candidacy" ADD CONSTRAINT "candidacy_vulnerability_indicator_id_fkey" FOREIGN KEY ("vulnerability_indicator_id") REFERENCES "vulnerability_indicator"("id") ON DELETE SET NULL ON UPDATE CASCADE;
